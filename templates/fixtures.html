{% extends "base.html" %}
{% block content %}
<h2 class="mb-4 text-center">游늰 Pr칩ximos Partidos</h2>

{% if next_matches %}
  <ul class="list-group mb-5">
    {% for match in next_matches %}
      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
        <div class="col-md-5 d-flex align-items-center">
          <img src="{{ match.homeTeam.logo }}" alt="{{ match.homeTeam.name }}" class="me-2" style="height:30px;">
          <strong>{{ match.homeTeam.name }}</strong>
        </div>
        <div class="col-md-2 text-center fw-bold">vs</div>
        <div class="col-md-5 d-flex align-items-center justify-content-end">
          <strong>{{ match.awayTeam.name }}</strong>
          <img src="{{ match.awayTeam.logo }}" alt="{{ match.awayTeam.name }}" class="ms-2" style="height:30px;">
        </div>
        <div class="col-12 mt-2 d-flex justify-content-between">
          <span>{{ match.startTimestamp | datetimeformat }}</span>
          <span class="badge bg-secondary">{{ match.tournament.name }}</span>
        </div>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <div class="alert alert-info text-center">
    No hay partidos pr칩ximos registrados por ahora.
  </div>
{% endif %}


<h2 class="mb-4 text-center">游닆 칔ltimos 6 Partidos Jugados</h2>

<!-- Leyenda en un card -->
<div class="card mb-4 shadow-sm">
  <div class="card-body text-center">
    <h5 class="card-title mb-3">Leyenda Resultados</h5>
    <span class="badge bg-success me-2">Victoria 游릭</span>
    <span class="badge bg-danger me-2">Derrota 游댮</span>
    <span class="badge bg-warning text-dark">Empate 游리</span>
  </div>
</div>

{% if past_matches %}
  <ul class="list-group">
    {% for match in past_matches %}
      {% set u_is_home = match.homeTeam.id == 2305 %}

      {# Marcadores seguros (si no existe, muestra "-") #}
      {% set home_score = match.homeScore.current if match.homeScore is defined and match.homeScore.current is defined else "-" %}
      {% set away_score = match.awayScore.current if match.awayScore is defined and match.awayScore.current is defined else "-" %}

      {% set u_score = home_score if u_is_home else away_score %}
      {% set rival_score = away_score if u_is_home else home_score %}

      {% if u_score != "-" and rival_score != "-" %}
        {% if u_score > rival_score %}
          {% set result_class = "list-group-item-success" %}
        {% elif u_score < rival_score %}
          {% set result_class = "list-group-item-danger" %}
        {% else %}
          {% set result_class = "list-group-item-warning" %}
        {% endif %}
      {% else %}
        {% set result_class = "" %}
      {% endif %}

      <li class="list-group-item {{ result_class }} d-flex justify-content-between align-items-center flex-wrap">
        <div class="col-md-5 d-flex align-items-center">
          <img src="{{ match.homeTeam.logo }}" alt="{{ match.homeTeam.name }}" class="me-2" style="height:30px;">
          <strong>{{ match.homeTeam.name }}</strong>
        </div>
        <div class="col-md-2 text-center fw-bold">
          {{ home_score }} - {{ away_score }}
        </div>
        <div class="col-md-5 d-flex align-items-center justify-content-end">
          <strong>{{ match.awayTeam.name }}</strong>
          <img src="{{ match.awayTeam.logo }}" alt="{{ match.awayTeam.name }}" class="ms-2" style="height:30px;">
        </div>
        <div class="col-12 mt-2 d-flex justify-content-between">
          <span>{{ match.startTimestamp | datetimeformat }}</span>
          <span class="badge bg-dark">{{ match.tournament.name }}</span>
        </div>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <div class="alert alert-info text-center">
    No hay partidos jugados registrados por ahora.
  </div>
{% endif %}

{% endblock %}
